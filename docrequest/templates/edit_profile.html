{% extends 'base.html' %}
{% block title %}Edit Profile{% endblock %}

{% block extra_css %}
<style>
:root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --glass-bg: rgba(255, 255, 255, 0.9);
    --glass-border: rgba(255, 255, 255, 0.18);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
}

.glass-card {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    box-shadow: var(--shadow-md);
}

.header-card {
    background: var(--primary-gradient);
    color: white;
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
}

.form-section {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 1.5rem;
}
</style>
{% endblock %}

{% block content %}
<div class="container mt-4 pb-5">
    <a href="{% url 'user_profile' %}" class="btn btn-outline-secondary mb-3">
        <i class="fas fa-arrow-left me-2"></i>Back to Profile
    </a>

    <div class="header-card">
        <h2>
            <i class="fas fa-user-edit me-3"></i>Edit My Profile
        </h2>
        <p class="mb-0 opacity-75">Update your personal and academic information</p>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="glass-card p-4">
                <form method="post">
                    {% csrf_token %}
                    
                    <!-- Personal Information -->
                    <div class="form-section">
                        <h5 class="mb-4">
                            <i class="fas fa-user text-primary me-2"></i>Personal Information
                        </h5>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-user me-1"></i>First Name *
                                </label>
                                <input type="text" name="first_name" class="form-control" value="{{ user.first_name }}" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-user me-1"></i>Last Name *
                                </label>
                                <input type="text" name="last_name" class="form-control" value="{{ user.last_name }}" required>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                <i class="fas fa-envelope me-1"></i>Email Address *
                            </label>
                            <input type="email" name="email" class="form-control" value="{{ user.email }}" required>
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>This email will be used for notifications
                            </small>
                        </div>
                    </div>

                    <!-- Academic Information -->
                    <div class="form-section">
                        <h5 class="mb-4">
                            <i class="fas fa-graduation-cap text-success me-2"></i>Academic Information
                        </h5>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-id-badge me-1"></i>School ID
                                </label>
                                <input type="text" class="form-control" value="{{ profile.school_id }}" readonly>
                                <small class="text-muted">
                                    <i class="fas fa-lock me-1"></i>School ID cannot be changed
                                </small>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-user-tag me-1"></i>Role
                                </label>
                                <input type="text" class="form-control" value="{{ profile.get_role_display }}" readonly>
                                <small class="text-muted">
                                    <i class="fas fa-lock me-1"></i>Role cannot be changed
                                </small>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-building me-1"></i>Department/College
                                </label>
                                <input type="text" name="department" class="form-control" value="{{ profile.department|default:'' }}" placeholder="e.g., College of Engineering">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-book me-1"></i>Course/Program
                                </label>
                                <input type="text" name="course" class="form-control" value="{{ profile.course|default:'' }}" placeholder="e.g., BS Computer Science">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-layer-group me-1"></i>Year Level
                                </label>
                                <select name="year_level" class="form-select">
                                    <option value="">Select Year Level</option>
                                    <option value="1st Year" {% if profile.year_level == '1st Year' %}selected{% endif %}>1st Year</option>
                                    <option value="2nd Year" {% if profile.year_level == '2nd Year' %}selected{% endif %}>2nd Year</option>
                                    <option value="3rd Year" {% if profile.year_level == '3rd Year' %}selected{% endif %}>3rd Year</option>
                                    <option value="4th Year" {% if profile.year_level == '4th Year' %}selected{% endif %}>4th Year</option>
                                    <option value="Graduate" {% if profile.year_level == 'Graduate' %}selected{% endif %}>Graduate</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-calendar-alt me-1"></i>Graduation Year
                                </label>
                                <input type="number" name="graduation_year" class="form-control" value="{{ profile.graduation_year|default:'' }}" placeholder="e.g., 2025" min="2000" max="2050">
                            </div>
                        </div>
                    </div>

                    <!-- Change Password (Optional) -->
                    <div class="form-section">
                        <h5 class="mb-4">
                            <i class="fas fa-lock text-warning me-2"></i>Change Password (Optional)
                        </h5>
                        
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                <i class="fas fa-key me-1"></i>Current Password
                            </label>
                            <input type="password" name="current_password" class="form-control" placeholder="Enter current password">
                            <small class="text-muted">Required only if changing password</small>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-lock me-1"></i>New Password
                                </label>
                                <input type="password" name="new_password" class="form-control" placeholder="Enter new password" minlength="8">
                                <small class="text-muted">Minimum 8 characters</small>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">
                                    <i class="fas fa-lock me-1"></i>Confirm Password
                                </label>
                                <input type="password" name="confirm_password" class="form-control" placeholder="Confirm new password" minlength="8">
                            </div>
                        </div>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                        <a href="{% url 'user_profile' %}" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-times me-2"></i>Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <div class="col-lg-4">
            <!-- Profile Summary -->
            <div class="glass-card p-4 mb-3">
                <h6 class="fw-bold mb-3">
                    <i class="fas fa-info-circle text-info me-2"></i>Profile Summary
                </h6>
                <div class="text-center mb-3">
                    <div class="rounded-circle bg-primary bg-opacity-10 text-primary d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                        <i class="fas fa-user fa-3x"></i>
                    </div>
                    <h5 class="mt-3 mb-1">{{ user.get_full_name }}</h5>
                    <p class="text-muted small mb-0">{{ profile.school_id }}</p>
                </div>
                <div class="alert alert-light small mb-0">
                    <ul class="mb-0">
                        <li>Joined: {{ profile.created_at|date:"M d, Y" }}</li>
                        <li>Last updated: {{ profile.updated_at|date:"M d, Y" }}</li>
                    </ul>
                </div>
            </div>

            <!-- What You Can Edit -->
            <div class="alert alert-success">
                <h6 class="alert-heading">
                    <i class="fas fa-check-circle me-2"></i>What You Can Edit
                </h6>
                <ul class="small mb-0">
                    <li>Name and email address</li>
                    <li>Department and course</li>
                    <li>Year level and graduation year</li>
                    <li>Password (optional)</li>
                </ul>
            </div>

            <!-- What You Cannot Edit -->
            <div class="alert alert-warning">
                <h6 class="alert-heading">
                    <i class="fas fa-lock me-2"></i>Cannot Be Changed
                </h6>
                <ul class="small mb-0">
                    <li>School ID</li>
                    <li>Role (Student/Alumni/Faculty)</li>
                    <li>Verification status</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}